#!/bin/bash

# Get the directory of the current script
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

# Define the virtual environment directory
VENV_DIR="$SCRIPT_DIR/../.venv"

# Path to the Python script you want to run
# Make sure to provide the relative path from the script directory
PYTHON_SCRIPT="$SCRIPT_DIR/../run.py"

# Check if the virtual environment directory exists
if [ ! -d "$VENV_DIR" ]; then
    echo "Creating virtual environment in $VENV_DIR..."
    python3 -m venv $VENV_DIR
fi

# Activate the virtual environment
source $VENV_DIR/bin/activate

# Install dependencies from requirements.txt, if it exists
if [ -f "$SCRIPT_DIR/requirements.txt" ]; then
    echo "Installing dependencies..."
    pip install -r "$SCRIPT_DIR/../requirements.txt"
fi

# Run your Python script
echo "Running Python script..."
python $PYTHON_SCRIPT

# Deactivate the virtual environment when done
deactivate
